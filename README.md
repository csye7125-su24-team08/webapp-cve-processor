# CVE Processor Webapp

This project contains an app that processes all the CVEs from the ZIP provided by the CVE website and stores them in a PostgreSQL database. The database has been set up using Flyway to prepare the tables and indexes.

## Database Migrations

We are using Flyway for database migrations for our app. The migrations are kept in the `sql` folder, and new migrations will be added here.

Flyway requires some environment variables that are important to pass when running the container:

- `flyway.url` - `$FLYWAY_URL`
- `flyway.user` - `$FLYWAY_USER`
- `flyway.password` - `$FLYWAY_PASSWORD`
- `flyway.defaultSchema` - `$FLYWAY_DEFAULT_SCHEMA`

These variables can be set using Docker environment variables or, in our case, Kubernetes secrets with Helm.

## Docker Migrations for `db_migration`

The `Dockerfile.migrate` will be run as an init container. This is an idempotent migration container that will run before our webapp attempts to process CVEs.
